import{a as u,A as p}from"./apiClient-TX8OfoMt.js";import{a as f}from"./read-gL9pyNTq.js";import{a as g}from"./authGuard-D1nHpxub.js";async function y(o,t){const n=`${p}/${o}`;return await u(n,"PUT",t)}async function w(o){o.preventDefault();const t=o.target,n=document.getElementById("edit-btn"),a=document.getElementById("edit-spinner"),e=t.elements.title.value.trim(),m=t.elements.body.value.trim(),i=t.elements.tags.value.trim(),d=i?i.split(",").map(s=>s.trim()):[],c=t.elements.media.value.trim()||null,r=new URLSearchParams(window.location.search).get("id");if(!r){console.error("No post ID found in query parameters");return}const l={title:e,body:m,tags:d,media:c};try{n.disabled=!0,a.hidden=!1,await y(r,l);const s=document.getElementById("success-msg");s.textContent="Post updated successfully!",setTimeout(()=>{window.location.href=`/post/?id=${r}`},2e3)}catch(s){console.error(s),document.getElementById("error-message").textContent=s.message}finally{n.disabled=!1,a.hidden=!0}}g();(async function(){const t=document.forms.editPost,a=new URLSearchParams(window.location.search).get("id");if(!t||!a){console.error("Edit form or post ID not found");return}try{const e=await f(a);t.elements.title.value=(e.title||"").trim(),t.elements.body.value=(e.body||"").trim(),t.elements.tags.value=(e.tags||[]).join(",").trim(),t.elements.media.value=(e.media||"").trim()}catch(e){console.error("Failed to load post for editing;",e)}t.addEventListener("submit",w)})();
