import{a as c,b as d,c as u}from"./apiClient-TX8OfoMt.js";async function g(e){return await c(d,"POST",e)}async function y(){try{const e=await c(u,"POST",{});return console.log("API key created successfully:",e),e&&e.key?(localStorage.setItem("noroffApiKey",e.key),console.log("API key stored in localStorage:",e.key)):console.warn("API key response did not contain a key:",e),e}catch(e){throw console.error("Error creating API key:",e),e}}async function f(e){e.preventDefault();const n=e.target,a=n.elements.email.value.trim(),l=n.elements.password.value,i={email:a,password:l},s=document.getElementById("error-message"),r=document.getElementById("login-success-msg"),o=document.getElementById("login-spinner");s.textContent="",r.textContent="",o.hidden=!1;try{const{data:t}=await g(i);if(!t?.accessToken)throw new Error("No access token returned.");localStorage.setItem("accessToken",t.accessToken),localStorage.setItem("username",t.name);const m=await y();console.log("API key:",m?.key),o.hidden=!0,r.textContent="✅ Login successful! Redirecting…",setTimeout(()=>{window.location.href="/"},2e3)}catch(t){o.hidden=!0,console.error("Login error:",t),s.textContent=t.message}}const k=document.forms.login;k.addEventListener("submit",f);
